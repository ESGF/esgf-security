<?xml version="1.0" encoding="UTF-8"?>

<!-- Application-specific Spring configuration file -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">
      	
    <!--ESG SAML-based Attribute Service stack (with example white list) -->
    <bean name="attributeServiceController" class="esg.security.attr.web.SAMLAttributeServiceSoapController">
    	<property name="whiteListCertificateProvider" ref="whiteList"/>
    </bean>
    <bean name="samlAttributeService" class="esg.security.attr.service.impl.SAMLAttributeServiceSoapImpl" />
 	<!-- Example implementation of SAMLAttributeFactory, configured to write SAML attributes of a specific "name" -->
  	<bean id="samlAttributeFactory" class="esg.security.attr.service.impl.SAMLAttributeFactoryTrivialImpl">
  		<property name="samlStringAttributeName"><value>urn:esgf:test:attribute_name</value></property>
  		<property name="samlGroupRoleAttributeName"><value>urn:esgf:test:grouprole</value></property>
  	</bean>
  	
  	<!-- ESG SAML-based Authorization Service stack (with example white list) -->
  	<bean name="authorizationServiceController" class="esg.security.authz.web.SAMLAuthorizationServiceSoapController">
  		<property name="whiteListCertificateProvider" ref="whiteList"/>
  	</bean>
  	<bean name="samlAuthorizationService" class="esg.security.authz.service.impl.SAMLAuthorizationServiceSoapImpl" />
  	<bean id="samlAuthorizationFactory" class="esg.security.authz.service.impl.SAMLAuthorizationFactoryTrivialImpl"/>
  	
  	<!-- Example white list -->
  	<bean name="whiteList" class="esg.security.common.WhiteListCertificateProvider">
  		<constructor-arg index="0">
  			<list>
  				<value>CN=https://esg-gateway.jpl.nasa.gov/myopenid/rootAdmin, OU=jpl-esg.jpl.nasa.gov, OU=ESG-JPL, O=ESG</value>
  			</list>
  		</constructor-arg>
  	</bean>
  	

</beans>
